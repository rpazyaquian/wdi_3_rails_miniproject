require 'rails_helper'

RSpec.describe Character, :type => :model do

  before(:all) do
    @munchkins = Party.create(name: "Munchkins", goal: "Loot literally everything", motto: "FBGMST")

    @healbot = @munchkins.characters.create(name: 'Healbot', job: :healer)
    @slashy = @munchkins.characters.create(name: 'Slashy', job: :dps)
    @stabby = @munchkins.characters.create(name: 'Stabby', job: :dps)
    @nukey = @munchkins.characters.create(name: 'Nukey', job: :dps)
    @chunky = @munchkins.characters.create(name: 'Chunky', job: :tank)
  end

  describe "instance" do
    it "outputs job as a properly formatted string" do
      jobs = [@chunky, @nukey, @healbot].map do |character|
        character.job
      end

      expect(jobs).to eq(["Tank", "DPS", "Healer"])

    end

    it "levels up" do
      before_level = @chunky.level
      after_level = @chunky.level_up
      expect(after_level > before_level).to be_true
    end

  end
end
